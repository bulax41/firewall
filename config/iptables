*mangle
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
COMMIT
*nat
:PREROUTING ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A POSTROUTING -o gre+ -j ACCEPT
-A POSTROUTING -o tun+ -j ACCEPT
COMMIT
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
:DROPnLOG - [0:0]
:FORWARDnDROP - [0:0]
:INBOUNDnDROP - [0:0]
:OUTPUTnDROP - [0:0]
:INPUTnDROP - [0:0]
:OUTBOUNDnDROP - [0:0]
:INBOUND - [0:0]
:VPN_PEERS - [0:0]
:OUTBOUND - [0:0]
:INBOUND-DEFAULT - [0:0]
:OUTBOUND-DEFAULT - [0:0]
-A INPUT -m state --state RELATED -j ACCEPT
-A INPUT -m state --state ESTABLISHED -j ACCEPT
-A INPUT -m state --state INVALID -j DROP
-A INPUT -i lo -j ACCEPT
-A INPUT -p icmp -m limit --limit 10/s -j ACCEPT
-A INPUT -p udp -m udp --dport 1194 -m limit --limit 5/s -j ACCEPT
-A INPUT -p esp -j VPN_PEERS
-A INPUT -p 47 -j VPN_PEERS
-A INPUT -p udp -m udp --dport 500 -j VPN_PEERS
-A INPUT -p udp -m udp --dport 4500 -j VPN_PEERS
-A INPUT -j INPUTnDROP
-A INPUTnDROP -j DROP
-A VPN_PEERS -j DROP
-A FORWARD -j FORWARDnDROP
-A FORWARDnDROP -m limit --limit 5/s -j LOG --log-prefix "FORWARD DROP:  "
-A FORWARDnDROP -j DROP
-A OUTPUT -m state --state ESTABLISHED -j ACCEPT
-A OUTPUT -m state --state RELATED -j ACCEPT
-A OUTPUT -o lo -j ACCEPT
-A OUTPUT -p icmp -j ACCEPT
-A OUTPUT -o gre+ -j ACCEPT
-A OUTPUT -p udp -m udp --dport 53 -j ACCEPT
-A OUTPUT -p udp -m udp --dport 123 -j ACCEPT
-A OUTPUT -p udp -m udp --dport 500 -j VPN_PEERS
-A OUTPUT -p udp -m udp --dport 4500 -j VPN_PEERS
-A OUTPUT -p esp -j VPN_PEERS
-A OUTPUT -p 47 -j VPN_PEERS
-A OUTPUT -j OUTPUTnDROP
-A OUTPUTnDROP -m limit --limit 5/s -j LOG --log-prefix "OUTPUT DROP:  "
-A OUTPUTnDROP -j DROP
-A INBOUND -j INBOUNDnDROP
-A INBOUNDnDROP -j DROP
-A OUTBOUND -j OUTBOUNDnDROP
-A OUTBOUNDnDROP -j DROP
-A DROPnLOG -j DROP
-A OUTBOUND-DEFAULT -j OUTBOUNDnDROP
-A INBOUND-DEFAULT -j INBOUNDnDROP
COMMIT
